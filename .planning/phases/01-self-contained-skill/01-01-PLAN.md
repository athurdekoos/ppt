---
phase: 01-self-contained-skill
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - openteams-pptx/assets/logos/
  - openteams-pptx/references/brand.json
  - openteams-pptx/SKILL.md
autonomous: true
requirements: [ASSET-01, ASSET-02, ASSET-03, ASSET-04]

must_haves:
  truths:
    - "assets/logos/ is a real directory containing 6 PNG files, not a symlink"
    - "brand.json logo_assets paths resolve to real files relative to the skill directory"
    - "No file in openteams-pptx/ contains /home/mia/ or other absolute home-directory paths"
    - "generate_deck.py --demo produces a valid .pptx when run with python3"
  artifacts:
    - path: "openteams-pptx/assets/logos/logo-colored-horizontal.png"
      provides: "Full-color horizontal logo for light backgrounds"
    - path: "openteams-pptx/assets/logos/logo-colored-vertical.png"
      provides: "Full-color vertical logo"
    - path: "openteams-pptx/assets/logos/logo-white-horizontal.png"
      provides: "White horizontal logo for dark backgrounds"
    - path: "openteams-pptx/assets/logos/logo-black-horizontal.png"
      provides: "Black horizontal logo"
    - path: "openteams-pptx/assets/logos/favicon-colored.png"
      provides: "Full-color favicon"
    - path: "openteams-pptx/assets/logos/favicon-white.png"
      provides: "White favicon for dark backgrounds"
    - path: "openteams-pptx/references/brand.json"
      provides: "Brand config with updated logo_assets paths"
      contains: "assets/logos/logo-colored-horizontal.png"
    - path: "openteams-pptx/SKILL.md"
      provides: "Skill documentation with portable python3 references"
  key_links:
    - from: "openteams-pptx/references/brand.json"
      to: "openteams-pptx/assets/logos/*.png"
      via: "logo_assets relative paths"
      pattern: "assets/logos/logo-"
    - from: "openteams-pptx/scripts/brand_engine.py"
      to: "openteams-pptx/references/brand.json"
      via: "load_brand() resolves paths relative to skill_dir"
      pattern: "os.path.join.*skill_dir.*rel_path"
---

<objective>
Make the openteams-pptx skill directory fully self-contained and portable.

Purpose: The skill currently depends on a symlink to ../../Assets and contains hardcoded absolute paths in SKILL.md. This plan replaces the symlink with bundled PNG files, updates all path references to be relative, and verifies the result works standalone.

Output: A portable openteams-pptx directory with 6 bundled logo PNGs, updated brand.json paths, and no absolute path references.
</objective>

<execution_context>
@/home/mia/.agents/get-shit-done/workflows/execute-plan.md
@/home/mia/.agents/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@openteams-pptx/references/brand.json
@openteams-pptx/SKILL.md
@openteams-pptx/scripts/brand_engine.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace symlink with bundled logo PNGs</name>
  <files>
    openteams-pptx/assets/logos/logo-colored-horizontal.png
    openteams-pptx/assets/logos/logo-colored-vertical.png
    openteams-pptx/assets/logos/logo-white-horizontal.png
    openteams-pptx/assets/logos/logo-black-horizontal.png
    openteams-pptx/assets/logos/favicon-colored.png
    openteams-pptx/assets/logos/favicon-white.png
  </files>
  <action>
1. Remove the symlink at `openteams-pptx/assets/logos` (it currently points to `../../Assets`)
2. Create a real directory `openteams-pptx/assets/logos/`
3. Copy the 6 referenced PNGs from `Assets/` into the new directory with clean flat names:

| Source (under Assets/) | Destination |
|----------------------|-------------|
| OT_Colored_Logos/Colored-Horizontal-transparent-logo/OT-new-logo-final.png | logo-colored-horizontal.png |
| OT_Colored_Logos/Colored-vertical-transparent-logo/OT-new-logo-vertical-lockup.png | logo-colored-vertical.png |
| OT_White_Logos/White-Horizontal-transparent-logo/OT-new-logo-final-white-horizontal-lockup.png | logo-white-horizontal.png |
| OT_Black_Logos/Black-Horizontal-transparent/OpenTeams_logo_horizontal_lockup_black.png | logo-black-horizontal.png |
| OT_Colored_Logos/Favicon-transparent-background/OpenTeams-favicon-01.png | favicon-colored.png |
| OT_White_Logos/White-Horizontal-transparent-logo/OT-new-logo-final-white-favicon.png | favicon-white.png |

4. Verify: `openteams-pptx/assets/logos` is NOT a symlink (`test ! -L`) and contains exactly 6 .png files.
  </action>
  <verify>
    <automated>test ! -L openteams-pptx/assets/logos && test "$(find openteams-pptx/assets/logos -maxdepth 1 -name '*.png' | wc -l)" -eq 6 && echo "PASS: 6 PNGs, no symlink" || echo "FAIL"</automated>
  </verify>
  <done>openteams-pptx/assets/logos/ is a real directory containing exactly 6 PNG files with clean names, no symlink</done>
</task>

<task type="auto">
  <name>Task 2: Update brand.json and SKILL.md path references</name>
  <files>
    openteams-pptx/references/brand.json
    openteams-pptx/SKILL.md
  </files>
  <action>
**brand.json:** Update the `logo_assets` section to use the new flattened paths:
```json
"logo_assets": {
  "colored_horizontal_png": "assets/logos/logo-colored-horizontal.png",
  "colored_vertical_png":   "assets/logos/logo-colored-vertical.png",
  "white_horizontal_png":   "assets/logos/logo-white-horizontal.png",
  "black_horizontal_png":   "assets/logos/logo-black-horizontal.png",
  "favicon_colored_png":    "assets/logos/favicon-colored.png",
  "favicon_white_png":      "assets/logos/favicon-white.png"
}
```

**SKILL.md:** Replace ALL occurrences of `/home/mia/.venvs/pptx/bin/python` with `python3`. There are 6 occurrences (lines 59, 124, 132, 140, 145, 152). Also remove or generalize the hardcoded example path `/home/mia/dev/ppt/openteams-pptx` on line 145 — replace with a generic description like "the absolute path to this skill's directory".

Do NOT change any other content in SKILL.md — only replace the absolute path references.
  </action>
  <verify>
    <automated>python3 -c "import json; d=json.load(open('openteams-pptx/references/brand.json')); [exit(1) for k,v in d['logo_assets'].items() if 'OT_' in v]" && ! grep -q '/home/mia/' openteams-pptx/SKILL.md && echo "PASS" || echo "FAIL"</automated>
  </verify>
  <done>brand.json logo_assets uses flattened paths; SKILL.md has no absolute paths</done>
</task>

<task type="auto">
  <name>Task 3: Full portability scan and demo generation test</name>
  <files></files>
  <action>
1. **Scan for absolute paths** across ALL files in `openteams-pptx/` (excluding __pycache__):
   ```bash
   grep -rn '/home/' openteams-pptx/ --include='*.py' --include='*.md' --include='*.json' --include='*.sh' | grep -v __pycache__
   ```
   This MUST return zero results. If any remain, fix them.

2. **Scan for symlinks** in the skill directory:
   ```bash
   find openteams-pptx/ -type l
   ```
   This MUST return zero results.

3. **Run demo generation** to prove the skill works end-to-end:
   ```bash
   cd openteams-pptx && python3 scripts/generate_deck.py --demo --brand references/brand.json --out /tmp/openteams_demo_test.pptx
   ```
   This must exit 0 and produce a non-empty .pptx file.

4. **Verify the output file** exists and is non-trivial:
   ```bash
   test -s /tmp/openteams_demo_test.pptx && echo "PASS" || echo "FAIL"
   ```

If any step fails, diagnose and fix the root cause before marking done.
  </action>
  <verify>
    <automated>cd openteams-pptx && python3 scripts/generate_deck.py --demo --brand references/brand.json --out /tmp/openteams_portability_test.pptx 2>&1 && test -s /tmp/openteams_portability_test.pptx && echo "PASS: Demo generated successfully" || echo "FAIL"</automated>
  </verify>
  <done>Zero absolute paths in skill directory, zero symlinks, demo .pptx generated successfully with python3</done>
</task>

</tasks>

<verification>
All four success criteria from ROADMAP Phase 1:
1. `assets/logos/` contains 6 PNG files directly (not a symlink) ✓
2. `brand.json` logo_assets paths resolve correctly from the skill directory ✓
3. No file in the skill directory contains `/home/mia/` or other absolute paths ✓
4. `generate_deck.py --demo` produces a valid .pptx when run from the skill directory with `python3` ✓
</verification>

<success_criteria>
- [ ] openteams-pptx/assets/logos/ is a real directory with 6 PNG files
- [ ] brand.json logo_assets paths all resolve to existing files
- [ ] `grep -rn '/home/' openteams-pptx/` returns nothing (excluding __pycache__)
- [ ] `find openteams-pptx/ -type l` returns nothing
- [ ] `python3 generate_deck.py --demo` exits 0 and produces valid .pptx
</success_criteria>

<output>
After completion, create `.planning/phases/01-self-contained-skill/01-01-SUMMARY.md`
</output>
